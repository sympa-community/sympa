<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with jLaTeX2HTML 2002 (1.62) JA patch-1.4
patched version by:  Kenshi Muto, Debian Project.
LaTeX2HTML 2002 (1.62),
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>16. Lists Families</TITLE>
<META NAME="description" CONTENT="16. Lists Families">
<META NAME="keywords" CONTENT="sympa">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="jLaTeX2HTML v2002 JA patch-1.4">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="sympa.css">

<LINK REL="next" HREF="node18.html">
<LINK REL="previous" HREF="node16.html">
<LINK REL="up" HREF="sympa.html">
<LINK REL="next" HREF="node18.html">
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#ffffff">
<!--Navigation Panel-->
<A NAME="tex2html1146"
  HREF="node18.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1140"
  HREF="sympa.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1134"
  HREF="node16.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1142"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1144"
  HREF="node25.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1147"
  HREF="node18.html">17. List configuration parameters</A>
<B> Up:</B> <A NAME="tex2html1141"
  HREF="sympa.html">Sympa Mailing Lists Management Software version</A>
<B> Previous:</B> <A NAME="tex2html1135"
  HREF="node16.html">15. List creation, families and list</A>
 &nbsp <B>  <A NAME="tex2html1143"
  HREF="node1.html">Contents</A></B> 
 &nbsp <B>  <A NAME="tex2html1145"
  HREF="node25.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html1148"
  HREF="node17.html#SECTION001710000000000000000">16.1 Family concept</A>
<LI><A NAME="tex2html1149"
  HREF="node17.html#SECTION001720000000000000000">16.2 Using family</A>
<UL>
<LI><A NAME="tex2html1150"
  HREF="node17.html#SECTION001721000000000000000">16.2.1 Definition</A>
<LI><A NAME="tex2html1151"
  HREF="node17.html#SECTION001722000000000000000">16.2.2 Instantiation</A>
<LI><A NAME="tex2html1152"
  HREF="node17.html#SECTION001723000000000000000">16.2.3 Modification</A>
<LI><A NAME="tex2html1153"
  HREF="node17.html#SECTION001724000000000000000">16.2.4 Closure</A>
<LI><A NAME="tex2html1154"
  HREF="node17.html#SECTION001725000000000000000">16.2.5 Adding one list</A>
<LI><A NAME="tex2html1155"
  HREF="node17.html#SECTION001726000000000000000">16.2.6 Removing one list</A>
<LI><A NAME="tex2html1156"
  HREF="node17.html#SECTION001727000000000000000">16.2.7 Modifying one list</A>
<LI><A NAME="tex2html1157"
  HREF="node17.html#SECTION001728000000000000000">16.2.8 List parameters edition in a family context</A>
</UL></UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION001700000000000000000"></A>
    <A NAME="lists-families"></A>    <A NAME="2483"></A>
<BR>
16. Lists Families
</H1>

<P>
A list can have from three parameters to many tens of them. Some listmasters need to create 
a set of lists that have the same profile. In order to simplify the apprehension of these parameters, 
list families define a lists typology.
Families provide a new level for defaults : in the past, defaults in Sympa were global and 
most sites using Sympa needed multiple defaults for different group of lists.
Moreover families allow listmaster to delegate a part of configuration list to owners, in a controlled way 
according to family properties.
Distribution will provide defaults families.

<P>

<H1><A NAME="SECTION001710000000000000000"></A>
     <A NAME="family-concept"></A>
<BR>
16.1 Family concept
</H1>

<P>
A family provides a model for all of its lists. It is specified by the following characteristics :

<P>

<UL>
<LI>a list creation template providing a common profile for each list configuration file.
</LI>
<LI>an degree of independence between the lists and the family : list parameters edition rights and 
constraints on these parameters can be <I>free</I> (no constraint), <I>controlled</I> (a set of 
available values is defined for these parameters) or <I>fixed</I> (the value for the parameter is imposed by 
the family). That prevents lists from diverging from the original and it allows list owner customizations in 
a controlled way. 
</LI>
<LI>a filiation kept between lists and family all along the list life : family modifications 
are applied on lists while keeping listowners customizations.

<P>
</LI>
</UL>

<P>
Here is a list of operation performed on a family : 

<P>

<UL>
<LI>definition : definition of the list creation template, the degree of independence and family customizations.
</LI>
<LI>instantiation : lists creation or modifications of existing lists while respecting family properties.
          The set of data defining the lists is an XML document. 
</LI>
<LI>modification : modification of family properties. The modification is effective at the next instantiation time, that have consequences on every list.
</LI>
<LI>closure : closure of each list.
</LI>
<LI>adding one list to a family.
</LI>
<LI>closing one family list.
</LI>
<LI>modifying one family list.

<P>
</LI>
</UL>

<P>

<H1><A NAME="SECTION001720000000000000000"></A>
    <A NAME="using-family"></A>
<BR>
16.2 Using family
</H1>

<P>

<H2><A NAME="SECTION001721000000000000000">
16.2.1 Definition</A>
</H2>
Families can be defined at the robot level, at  the site level or on the distribution level
 (where default families are provided).
So, you have to create a sub directory named after the family's name in a <A NAME="8168"></A><TT>families</TT> directory  : 

<P>
<I>Examples:</I> <PRE>
/home/sympa/etc/families/my_family
/home/sympa/etc/my_robot/families/my_family
</PRE>
In this directory you must provide these files :

<UL>
<LI><A NAME="8171"></A><TT>config.tt2</TT> (mandatory)
</LI>
<LI><A NAME="8174"></A><TT>param_constraint.conf</TT> (mandatory)
</LI>
<LI><A NAME="8177"></A><TT>edit_list.conf</TT>
</LI>
<LI>customizable files
</LI>
</UL>

<P>

<H3><A NAME="SECTION001721100000000000000"></A>
   <A NAME="using-family-config-tpl"></A>
<BR>
16.2.1.1 config.tt2
</H3>
      This is a list creation template, this file is mandatory. It provides default values for parameters. 
      This file is an almost complete list configuration, with a number of missing fields 
      (such as owner e-mail) to be replaced by data obtained at the time of family instantiation.
      It is easy to create new list templates by modifying existing ones. See <A HREF="node15.html#list-tpl">14.8</A>, page&nbsp;<A HREF="node15.html#list-tpl"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>
      and <A HREF="node14.html#tpl-format">13.1</A>, page&nbsp;<A HREF="node14.html#tpl-format"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.
<BR>
<P>
<I>Example:</I> <PRE>
subject [% subject %]

status [% status %]

[% IF topic %]
topics [% topic %]

[% END %]
visibility noconceal

send privateoreditorkey

web_archive
  access public

subscribe open_notify

shared_doc
  d_edit [% shared_edit %]
  d_read [% shared_read %]

lang [% language %]

[% FOREACH o = owner %]
owner
  email [% o.email %]
  profile privileged
  [% IF o.gecos %] 
  gecos [% o.gecos %]
  [% END %]

[% END %]
[% IF moderator %]
   [% FOREACH m = moderator %]
editor
  email [% m.email %]

   [% END %]
[% END %]
 
[% IF sql %]
include_sql_query
  db_type [% sql.type %]
  host [% sql.host %]
  user [% sql.user %]
  passwd [% sql.pwd %]
  db_name [% sql.name %]
  sql_query [% sql.query %]
    
[% END %]
ttl 360
</PRE>

<P>

<H3><A NAME="SECTION001721200000000000000"></A>
     <A NAME="2519"></A>
<BR>
16.2.1.2 param_constraint.conf
</H3>
         This file is obligatory. It defines constraints on parameters. There are three kind of constraints :
	 
<UL>
<LI><I>free</I> parameters : no constraint on these parameters, 
                  they are not written in the <A NAME="8180"></A><TT>param_constraint.conf</TT> file.
</LI>
<LI><I>controlled</I> parameters : these parameters must select their values 
                  in a set of available values indicated in the <A NAME="8183"></A><TT>param_constraint.conf</TT> file.
</LI>
<LI><I>fixed</I> parameters : these parameters must have the imposed value indicated
	          in the <A NAME="8186"></A><TT>param_constraint.conf</TT> file.

<P>
</LI>
</UL>
	 The parameters constraints will be checked at every list loading.

<P>
<I>Example:</I> <PRE>
lang                fr,us			
archive.period      days,week,month	
visibility          conceal,noconceal	
shared_doc.d_read   public		
shared_doc.d_edit   editor
</PRE>

<P>

<H3><A NAME="SECTION001721300000000000000">
16.2.1.3 edit_list.conf</A>
</H3>
        This is an optional file. It defines which parameters/files are editable by
	owners. See <A HREF="node16.html#list-edition">15.4.4</A>, page&nbsp;<A HREF="node16.html#list-edition"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.
	If the family does not have this file, <I>Sympa</I> will look for 
	the one defined on robot level, server site level or distribution level. 
	(This file already exists without family context)
<BR>
Notes that by default parameter family_name is not writable, you should not change 
	this edition right.

<P>

<H3><A NAME="SECTION001721400000000000000">
16.2.1.4 customizable files</A>
</H3>
        Families provides a new level of customization for scenarios (see <A HREF="node12.html#scenarios">11</A>, 
	page&nbsp;<A HREF="node12.html#scenarios"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>), templates for service messages (see <A HREF="node14.html#site-tpl">13.2</A>, 
	page&nbsp;<A HREF="node14.html#site-tpl"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>) and templates for web pages (see <A HREF="node14.html#web-tpl">13.3</A> , 
	page&nbsp;<A HREF="node14.html#web-tpl"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>). <I>Sympa</I> looks for these files in the following 
	level order: list, family, robot, server site or distribution. 

<P>

<H2><A NAME="SECTION001722000000000000000"></A>
<A NAME="family-instantiation"></A>
<BR>
16.2.2 Instantiation
</H2>

<P>
Instantiation permits to generate lists.You must provide an XML file that is 
composed of lists description, the root element is <I>family</I> and is only 
composed of <I>list</I> elements. List elements are described in section 
<A HREF="node16.html#list-creation-sympa">15.3</A>, page&nbsp;<A HREF="node16.html#list-creation-sympa"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>. Each list is described 
by the set of values for affectation list parameters.

<P>
Here is an sample command to instantiate a family :<PRE>
sympa.pl --instantiate\_family my_family --robot \samplerobot --input\_file my\_file.xml
</PRE>
This means lists that belong to family <A NAME="8189"></A><TT>my_family</TT> will be created under the robot 
<A NAME="8192"></A><TT>my_robot</TT> and these lists are described in the file <A NAME="8195"></A><TT>my_file.xml</TT>. Sympa will split this file 
into several xml files describing lists. Each list XML file is put in each list directory.
<BR>
<P>
<I>Example:</I> <PRE>
&lt;family&gt;
  &lt;list&gt; ... &lt;listname&gt; liste1 &lt;/listname&gt; ... &lt;/list&gt;
  &lt;list&gt; ...                                   &lt;/list&gt;
  &lt;list&gt; ...                                   &lt;/list&gt;
   ...
&lt;/family&gt;
</PRE>

<P>
Each instantiation describes lists. Compared to the previous instantiation, there are three cases :

<UL>
<LI>lists creation : new lists described by the new instantiation
</LI>
<LI>lists modification : lists already existing but possibly changed because of changed parameters values in
        the XML file or because of changed family's properties.
</LI>
<LI>lists removal : lists nomore described by the new instantiation. In this case, the listmaster must 
        valid his choice on command line. If the list is removed, it is set in status <A NAME="8198"></A><TT>family_closed</TT>, or if the 
	list is recovered, the list XML file from the previous instantiation is got back to go on as a list modification then.

<P>
</LI>
</UL>

<P>
After list creation or modification, parameters constraints are checked :

<UL>
<LI><I>fixed</I> parameter : the value must be the one imposed.
</LI>
<LI><I>controlled</I> parameter : the value must be one of the set of available values.
</LI>
<LI><I>free</I> parameter : there is no checking.

<P>
</LI>
</UL>

<P>
diagram

<P>
In case of modification (see diagram), allowed customizations can be preserved :

<UL>
<LI>(1) : for every modified parameters (via Web interface), noted in the <A NAME="8201"></A><TT>config_changes</TT> 
    file, values can be collected in the old list configuration file, according to new family properties :
    
<UL>
<LI><I>fixed</I> parameter : the value is not collected.
</LI>
<LI><I>controlled</I> parameter : the value is collected only if constraints are respected.
</LI>
<LI><I>free</I> parameter : the value is collected.
    
</LI>
</UL>
</LI>
<LI>(2) : a new list configuration file is made with the new family properties
</LI>
<LI>(3) : collected values are set in the new list configuration file.

<P>
</LI>
</UL>

<P>
Notes : 

<UL>
<LI>For each list problem (as family file error, error parameter constraint, error instanciation ...),
    the list is set in status <A NAME="8204"></A><TT>error_config</TT> and the listmaster is notified. He will have to do necessary to put list in use.
</LI>
<LI>For each list closing in family context, the list is set in status <A NAME="8207"></A><TT>family_closed</TT> and the owner is notified.
</LI>
<LI>For each overwritten list customization, the owner is notified. 
</LI>
</UL>

<P>

<H2><A NAME="SECTION001723000000000000000">
16.2.3 Modification</A>
</H2>
To modify a family, you have to edit family files manually. The modification will be effective while the next instanciation.
<BR><B>WARNING</B>: The family modification must be done just before an instantiation. If it is not, alive lists wouldn't respect 
new family properties and they would be set in status error_config immediately.

<P>

<H2><A NAME="SECTION001724000000000000000">
16.2.4 Closure</A>
</H2>

<P>
<A NAME="family-closure"></A>
<P>
Closes every list (installed under the indicated robot) 
 of this family : lists status are set to <A NAME="8210"></A><TT>family_closed</TT>, aliases are 
 removed and subscribers are removed from DB. (a dump is created in the list 
 directory to allow restoration of the list).

<P>
Here is a sample command to close a family :
 <BLOCKQUOTE>
sympa.pl -close_family my_family -robot my.domain.org
 
</BLOCKQUOTE> 

<P>

<H2><A NAME="SECTION001725000000000000000">
16.2.5 Adding one list</A>
</H2>

<P>
<A NAME="family-add-list"></A>
<P>
Adds a list to the family without instantiate all the family. The list is created
 as if it was created during an instantiation, under the indicated robot. The XML file
 describes the list and the root element is <A NAME="8213"></A><TT>&lt;list&gt;</TT>. List elements are described in section 
 <A HREF="node16.html#list-creation-sympa">15.3</A>, page&nbsp;<A HREF="node16.html#list-creation-sympa"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.

<P>
Here is a sample command to add a list to a family :
 <BLOCKQUOTE>
sympa.pl -add_list my_family -robot my.domain.org-input_file my_file.xml
 
</BLOCKQUOTE> 

<P>

<H2><A NAME="SECTION001726000000000000000">
16.2.6 Removing one list</A>
</H2>

<P>
Closes the list  installed under the indicated robot : the list status is set to
  <A NAME="8216"></A><TT>family_closed</TT>, aliases are 
 removed and subscribers are removed from DB. (a dump is created in the list 
 directory to allow restoring the list).

<P>
Here is a sample command to close a list family (same as an orphan list) :
 <BLOCKQUOTE>
sympa.pl -close_list my_list@my.domain.org
 
</BLOCKQUOTE> 

<P>

<H2><A NAME="SECTION001727000000000000000"></A>
 <A NAME="family-modify-list"></A>
<BR>
16.2.7 Modifying one list
</H2>

<P>
Modifies a family list without instantiating the whole family. The list (installed under the indicated robot) 
 is modified as if it was modified during an instantiation. The XML file
 describes the list and the root element is <A NAME="8219"></A><TT>&lt;list&gt;</TT>. List elements are described in section 
 <A HREF="node16.html#list-creation-sympa">15.3</A>, page&nbsp;<A HREF="node16.html#list-creation-sympa"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.

<P>
Here is a sample command to modify a list to a family :
 <BLOCKQUOTE>
sympa.pl -modify_list my_family -robot my.domain.org-input_file my_file.xml
 
</BLOCKQUOTE> 

<P>

<H2><A NAME="SECTION001728000000000000000"></A>
    <A NAME="list-param-edit-family"></A>
<BR>
16.2.8 List parameters edition in a family context
</H2>
According to file <A NAME="8222"></A><TT>edit_list.conf</TT>, edition rights are controlled.  
See <A HREF="node16.html#list-edition">15.4.4</A>, page&nbsp;<A HREF="node16.html#list-edition"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>. But in a family context, constraints parameters are 
added to edition right as it is summarized in this array :
<BR>
<P>
array
<BR>
<P>
Note : In order to preserve list customization for instantiation, every modified parameter (via the Web interface) is noted in the <A NAME="8225"></A><TT>config_changes</TT> file. 

<P>

<HR>
<!--Navigation Panel-->
<A NAME="tex2html1146"
  HREF="node18.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1140"
  HREF="sympa.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1134"
  HREF="node16.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1142"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1144"
  HREF="node25.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1147"
  HREF="node18.html">17. List configuration parameters</A>
<B> Up:</B> <A NAME="tex2html1141"
  HREF="sympa.html">Sympa Mailing Lists Management Software version</A>
<B> Previous:</B> <A NAME="tex2html1135"
  HREF="node16.html">15. List creation, families and list</A>
 &nbsp <B>  <A NAME="tex2html1143"
  HREF="node1.html">Contents</A></B> 
 &nbsp <B>  <A NAME="tex2html1145"
  HREF="node25.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
root
2004-12-14
</ADDRESS>
</BODY>
</HTML>
