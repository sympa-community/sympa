<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with jLaTeX2HTML 2002-2-1 (1.70) JA patch-2.0
patched version by:  Kenshi Muto, Debian Project.
* modified by:  Shige TAKENO
LaTeX2HTML 2002-2-1 (1.70),
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>18. List creation, families and list edition</TITLE>
<META NAME="description" CONTENT="18. List creation, families and list edition">
<META NAME="keywords" CONTENT="sympa">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="jLaTeX2HTML v2002-2-1 JA patch-2.0">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="sympa.css">

<LINK REL="next" HREF="node20.html">
<LINK REL="previous" HREF="node18.html">
<LINK REL="up" HREF="sympa.html">
<LINK REL="next" HREF="node20.html">
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#ffffff">
<!--Navigation Panel-->
<A NAME="tex2html1270"
  HREF="node20.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1264"
  HREF="sympa.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1258"
  HREF="node18.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1266"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1268"
  HREF="node30.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1271"
  HREF="node20.html">19. Lists Families</A>
<B> Up:</B> <A NAME="tex2html1265"
  HREF="sympa.html">Sympa Mailing Lists Management Software version</A>
<B> Previous:</B> <A NAME="tex2html1259"
  HREF="node18.html">17. Mailing list definition</A>
 &nbsp; <B>  <A NAME="tex2html1267"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1269"
  HREF="node30.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html1272"
  HREF="node19.html#SECTION001910000000000000000">18.1 List creation</A>
<UL>
<LI><A NAME="tex2html1273"
  HREF="node19.html#SECTION001911000000000000000">18.1.1 Data for list creation</A>
<LI><A NAME="tex2html1274"
  HREF="node19.html#SECTION001912000000000000000">18.1.2 XML file format</A>
</UL>
<BR>
<LI><A NAME="tex2html1275"
  HREF="node19.html#SECTION001920000000000000000">18.2 List families</A>
<LI><A NAME="tex2html1276"
  HREF="node19.html#SECTION001930000000000000000">18.3 List creation on command line with <TT>sympa.pl</TT></A>
<LI><A NAME="tex2html1277"
  HREF="node19.html#SECTION001940000000000000000">18.4 Creating and editing mailing using the web</A>
<UL>
<LI><A NAME="tex2html1278"
  HREF="node19.html#SECTION001941000000000000000">18.4.1 List creation on the Web interface</A>
<LI><A NAME="tex2html1279"
  HREF="node19.html#SECTION001942000000000000000">18.4.2 Who can create lists on the Web interface</A>
<LI><A NAME="tex2html1280"
  HREF="node19.html#SECTION001943000000000000000">18.4.3 typical list profile and Web interface</A>
<LI><A NAME="tex2html1281"
  HREF="node19.html#SECTION001944000000000000000">18.4.4 List edition</A>
</UL></UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION001900000000000000000"></A>
    <A NAME="ml-creation"></A>
<BR>
18. List creation, families and list edition
</H1>

<P>
The list creation can be done by two ways, according to listmaster 
needs : 

<UL>
<LI>instanciation family to create and manage large number of related lists. 
    In this case, lists are linked to their family all along their life.
</LI>
<LI>command line creation of individual list with <A NAME="9967"></A><TT>sympa.pl</TT> or on the Web 
interface according to privileges defined by listmasters. Here lists are free from 
their model creation.
</LI>
</UL> 
Management of mailing lists by list owners is usually done via the Web interface : 
when a list is created, whatever its status (<A NAME="9970"></A><TT>pending</TT> or <A NAME="9973"></A><TT>open</TT>), the owner 
can use WWSympa admin features to modify list parameters, or to edit the welcome 
message, and so on.

<P>
WWSympa keeps logs of the creation and all modifications to a list as part of the list's
<A NAME="9976"></A><TT>config</TT> file (old configuration files are archived).
A complete installation requires some careful planning, although default
values should be acceptable for most sites.

<P>

<H1><A NAME="SECTION001910000000000000000"></A>
    <A NAME="list-creation"></A>
<BR>
18.1 List creation
</H1>

<P>
Mailing lists can have many different uses. <I>Sympa</I> offers a
wide choice of parameters to adapt a list behavior
to different situations. Users might have difficulty selecting all the
correct parameters to make the list configuration, so instead of selecting each 
parameters, list configuration is made with a list profile. This is an 
almost complete list configuration, but with a number of unspecified fields
(such as owner e-mail) to be replaced by <I>Sympa</I> at list creation time. It is easy to create new list 
templates by modifying existing ones. (Contributions to the distribution are welcome...)

<P>

<H2><A NAME="SECTION001911000000000000000">
18.1.1 Data for list creation</A>
</H2>

<P>
To create a list, some data concerning list parameters are required : 

<UL>
<LI><B>listname </B> : name of the list,
</LI>
<LI><B>subject</B> : subject of the list (a short description),
</LI>
<LI><B>owner(s)</B> : by static definition and/or dynamic definition.
    In case of static definition, the parameter <B>owner</B> and its subparameter <B>email</B> are required.
    For dynamic definition, the parameter  <B>owner_include</B> and its subparameter <B>source</B> are required, 
    indicating source file of data inclusion.
</LI>
<LI><B>list creation template</B> : the typical list profile.
</LI>
</UL>

<P>
Moreover of these required data, provided values are assigned to vars being in the list creation template. 
Then the result is the list configuration file :
<BR>
<P>
On the Web interface, these data are given by the list creator in the web form. On command line these 
data are given by an xml file.

<P>

<H2><A NAME="SECTION001912000000000000000"></A>
<A NAME="xml-file-format"></A>
<BR>
18.1.2 XML file format
</H2>

<P>
The xml file provides information on :
<BR>
<UL>
<LI>the list name,
</LI>
<LI>values to assign vars in the list creation template
</LI>
<LI>the list description in order to be written in the list file info
</LI>
<LI>the name of the list creation template (only for list creation on command line with sympa.pl, in a family context, the template is specified by the family name)
</LI>
</UL>

<P>
Here is an example of XML document that you can map with the following example of list creation template.:

<P><PRE>
&lt;?xml version="1.0" ?&gt;
&lt;list&gt;
	&lt;listname&gt;example&lt;/listname&gt;
  	&lt;type&gt;my_profile&lt;/type&gt;
  	&lt;subject&gt;a list example&lt;/subject&gt;
  	&lt;description/&gt;
  	&lt;status&gt;open&lt;/status&gt;
  	&lt;shared_edit&gt;editor&lt;/shared_edit&gt;
    	&lt;shared_read&gt;private&lt;/shared_read&gt;
	&lt;language&gt;fr&lt;/language&gt;
	&lt;owner multiple="1"&gt; 
	   &lt;email&gt;serge.aumont@cru.fr&lt;/email&gt;
	   &lt;gecos&gt;C.R.U.&lt;/gecos&gt;
	&lt;/owner&gt;
	&lt;owner multiple="1"&gt; 
	   &lt;email&gt;olivier.salaun@cru.fr&lt;/email&gt;
	&lt;/owner&gt;
	&lt;owner_include multiple="1"&gt;
	   &lt;source&gt;my_file&lt;/source&gt;
	&lt;/owner_include&gt;
	&lt;sql&gt; 
	   &lt;type&gt;oracle&lt;/type&gt;
	   &lt;host&gt;sqlserv.admin.univ-x.fr&lt;/host&gt;
	   &lt;user&gt;stdutilisateur&lt;/user&gt;
	   &lt;pwd&gt;monsecret&lt;/pwd&gt;
	   &lt;name&gt;les_etudiants&lt;/name&gt;
	   &lt;query&gt;SELECT DISTINCT email FROM etudiant&lt;/query&gt;
	&lt;/sql&gt;
&lt;/list&gt;



subject [% subject %]

status [% status %]

[% IF topic %]
topics [% topic %]

[% END %]
visibility noconceal

send privateoreditorkey

Web_archive
  access public

subscribe open_notify

shared_doc
  d_edit [% shared_edit %]
  d_read [% shared_read %]

lang [% language %]

[% FOREACH o = owner %]
owner
  email [% o.email %]
  profile privileged
  [% IF o.gecos %] 
  gecos [% o.gecos %]
  [% END %]

[% END %]
[% IF moderator %]
   [% FOREACH m = moderator %]
editor
  email [% m.email %]

   [% END %]
[% END %]
 
[% IF sql %]
include_sql_query
  db_type [% sql.type %]
  host [% sql.host %]
  user [% sql.user %]
  passwd [% sql.pwd %]
  db_name [% sql.name %]
  sql_query [% sql.query %]
    
[% END %]
ttl 360
</PRE>

<P>
The XML file format should comply with the following rules : 

<UL>
<LI>The root element is <A NAME="9981"></A><TT>&lt;list&gt;</TT>
</LI>
<LI>One XML element is mandatory : <A NAME="9984"></A><TT>&lt;listname&gt;</TT> contains the name of the list.
        That not excludes mandatory parameters for list creation (<A NAME="9987"></A><TT>listname, subject,owner.email and/or 
	owner_include.source</TT>).
</LI>
<LI><A NAME="9990"></A><TT>&lt;type&gt;</TT> : this element contains the name of template list creation, it is used for list creation on command line with sympa.pl.
        In a family context, this element is no used.
</LI>
<LI><A NAME="9993"></A><TT>&lt;description&gt;</TT> : the text contained in this element is written in list <A NAME="9996"></A><TT>info</TT> file(it can be a CDATA section).
</LI>
<LI>For other elements, its name is the name of the var to assign in the list creation template. 
</LI>
<LI>Each element concerning multiple parameters must have the <A NAME="9999"></A><TT>multiple</TT> attribute set 
    to ``1'', example : <A NAME="10002"></A><TT>&lt;owner multiple=''1''></TT>. 
</LI>
<LI>For composed and multiple parameters, sub-elements are used. Example for <A NAME="10005"></A><TT>owner</TT> parameter :
    <A NAME="10008"></A><TT>&lt;email&gt;</TT> and <A NAME="10011"></A><TT>&lt;gecos&gt;</TT> elements are contained in the <A NAME="10014"></A><TT>&lt;owner&gt;</TT>element. 
    An element can only have homogeneous content.
</LI>
<LI>A list requires at least one owner, defined in the XML input file with one of the following elements :
    
<UL>
<LI><A NAME="10017"></A><TT>&lt;owner multiple=''1''> &lt;email&gt; ... &lt;/email&gt; &lt;/owner&gt;</TT>
</LI>
<LI><A NAME="10020"></A><TT>&lt;owner_include multiple=''1''> &lt;source&gt; ... &lt;/source&gt; &lt;/owner_include&gt;</TT>
    
</LI>
</UL>
</LI>
</UL>

<P>

<H1><A NAME="SECTION001920000000000000000">
18.2 List families</A>
</H1>

<P>
See chapter <A HREF="node20.html#lists-families">19</A>, page&nbsp;<A HREF="node20.html#lists-families"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>

<P>

<H1><A NAME="SECTION001930000000000000000"></A><A NAME="10023"></A>
    <A NAME="list-creation-sympa"></A>
<BR>
18.3 List creation on command line with <TT>sympa.pl</TT>
</H1>

<P>
This way to create lists is independent of family. 

<P>
Here is a sample command to create one list :.
<BLOCKQUOTE>
sympa.pl -create_list -robot my.domain.org-input_file /path/to/my_file.xml

</BLOCKQUOTE>

<P>
The list is created under the <A NAME="10026"></A><TT>my_robot</TT> robot and the list 
is described in the file <A NAME="10029"></A><TT>my_file.xml</TT>. The XML file is 
described before, see <A HREF="#xml-file-format">18.1.2</A>, page&nbsp;<A HREF="node19.html#xml-file-format"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.

<P>
By default, the status of the created list is <A NAME="10032"></A><TT>open</TT>.

<P>

<H3><A NAME="SECTION001930100000000000000"></A>
    <A NAME="typical-list-profile"></A>
<BR>
18.3.0.1 typical list profile (list template creation)
</H3>

<P>
The list creator has to choose a profile
for the list and put its name in the XML element <A NAME="10035"></A><TT>&lt;type&gt;</TT>.

<P>
List profiles are stored in <A NAME="10038"></A><TT>/tmp/sympa/etc/create_list_templates</TT> or in
<A NAME="10041"></A><TT>/tmp/sympa/bin/etc/create_list_templates</TT> (default of distrib).

<P>
You might want to hide or modify profiles (not useful, or dangerous 
for your site). If a profile exists both in the local site directory
<A NAME="10044"></A><TT>/tmp/sympa/etc/create_list_templates</TT> and
<A NAME="10047"></A><TT>/tmp/sympa/bin/etc/create_list_templates</TT> directory, then the local profile 
will be used by WWSympa. 

<P>

<H1><A NAME="SECTION001940000000000000000"></A>
    <A NAME="web-ml-creation"></A>
<BR>
18.4 Creating and editing mailing using the web
</H1>

<P>
The management of mailing lists is based on a strict definition of privileges 
which pertain respectively to the listmaster, to the main list owner, and to 
basic list owners. The goal is to allow each listmaster to define who can create 
lists, and which parameters may be set by owners.

<P>

<H2><A NAME="SECTION001941000000000000000">
18.4.1 List creation on the Web interface</A>
</H2>

<P>
Listmasters have all privileges. The listmaster
is defined in <A NAME="10050"></A><TT>sympa.conf</TT> and others are defined at the virtual robot level. By default, newly created
lists must be activated by the listmaster. List creation is possible for all intranet users 
(i.e. : users with an e-mail address within the same domain as Sympa).
This is controlled by the <A NAME="10053"></A><TT>create_list</TT> authorization scenario.

<P>
List rejection message and list creation notification message are both
templates that you can customize (<A NAME="10056"></A><TT>list_rejected.tt2</TT> and
<A NAME="10059"></A><TT>list_created.tt2</TT>).

<P>

<H2><A NAME="SECTION001942000000000000000">
18.4.2 Who can create lists on the Web interface</A>
</H2>

<P>
This is defined by the <A NAME="10062"></A><TT>create_list</TT> sympa.conf parameter (see <A HREF="node8.html#create-list">7.1.16</A>,  
page&nbsp;<A HREF="node8.html#create-list"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>). This parameter refers to a <B>create_list</B> authorization scenario.
It will determine if the <I>create list</I> button is displayed and if it requires
a listmaster confirmation.

<P>
The authorization scenario can accept any condition concerning the [sender]
(i.e. WWSympa user), and it returns <A NAME="10065"></A><TT>reject</TT>, <A NAME="10068"></A><TT>do_it</TT>
or <A NAME="10071"></A><TT>listmaster</TT> as an action.

<P>
Only in cases where a user is authorized by the create_list authorization scenario
will the "create" button be available in the main menu.
If the scenario returns <A NAME="10074"></A><TT>do_it</TT>, the list will be created and installed.
If the scenario returns "listmaster", the user is allowed to create a list, but
the list is created with the <A NAME="10077"></A><TT>pending</TT> status,
which means that only the list owner may view or use it.
The listmaster will need to open the list of pending lists
using the "pending list" button in the "server admin"
menu in order to install or refuse a pending list.

<P>

<H2><A NAME="SECTION001943000000000000000">
18.4.3 typical list profile and Web interface</A>
</H2>
As on command line creation, the list creator has to choose a list profile and to fill in the owner's e-mail 
and the list subject together with a short description. But in this case, you don't need any XML file. Concerning
these typical list profiles, they are described before, see <A HREF="#typical-list-profile">18.3</A>, page&nbsp;<A HREF="node19.html#typical-list-profile"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>. 
You can check available profile. On the Web interface, another way 
to control publicly available profiles is to
edit the <A NAME="10080"></A><TT>create_list.conf</TT> file (the default for this file is in
the <A NAME="10083"></A><TT>/tmp/sympa/bin/etc</TT> directory, and you may create your own customized
version in <A NAME="10086"></A><TT>/tmp/sympa/etc</TT>).
This file controls which of the available list templates are to be displayed. Example :<PRE>
# Do not allow the public_anonymous profile
public_anonymous hidden
* read
</PRE>

<P>

<H2><A NAME="SECTION001944000000000000000"></A>
<A NAME="list-edition"></A>
<BR>
18.4.4 List edition
</H2>

<P>
For each parameter, you may specify (via the <A NAME="10089"></A><TT>/tmp/sympa/etc/edit_list.conf</TT>
configuration file) who has the right to edit the parameter concerned ; the default 
<A NAME="10092"></A><TT>/tmp/sympa/bin/etc/edit_list.conf</TT> is reasonably safe.

<P>
<PRE>
Each line is a set of 3 field
&lt;Parameter&gt; &lt;Population&gt; &lt;Privilege&gt;
&lt;Population&gt; : &lt;listmaster|privileged_owner|owner&gt; 
&lt;Privilege&gt; : &lt;write|read|hidden&gt;
parameter named "default" means any other parameter
</PRE>

<P>
There is no hierarchical relation between  populations in this
configuration file. You need to explicitely list populations.

<P>
Eg: listmaster will not match rules refering to owner or privileged_owner

<P><PRE>
     examples :

	# only listmaster can edit user_data_source, priority, ...
	user_data_source listmaster write  

	priority 	owner,privileged_owner 		read
	priority 	listmaster 			write
      
	# only privileged owner can modify  editor parameter, send, ...
	editor privileged_owner write
	
	send 		owner 				read
	send 		privileged_owner,listmaster 	write

	# other parameters can be changed by simple owners
	default 	owner 				write
</PRE>

<P>
Privileged owners are defined in the list's <A NAME="10095"></A><TT>config</TT> file as follows :
	<PRE>
	owner
	email owners.email@foo.bar
	profile privileged
</PRE>

<P>
The following rules are hard coded in WWSympa :

<UL>
<LI>only listmaster can edit the "profile privileged"
      owner attribute 

<P>
</LI>
<LI>owners can edit their own attributes (except profile and e-mail)

<P>
</LI>
<LI>the requestor creating a new list becomes a privileged owner

<P>
</LI>
<LI>privileged owners can edit any gecos/reception/info attribute
of any owner

<P>
</LI>
<LI>privileged owners can edit owners' e-mail addresses (but not privileged owners' e-mail addresses)

<P>
</LI>
</UL>

<P>
Sympa aims to define two levels of trust for owners (some being entitled 
      simply to edit secondary parameters such as "custom_subject", others having
      the right to manage more important parameters), while leaving control of
      crucial parameters (such as the list of privileged owners and user_data_sources)
      in the hands of the listmaster.
      Consequently, privileged owners can change owners' e-mails,
      but they cannot grant the responsibility of list management to others without
      referring to the listmaster.

<P>
Concerning list edition in a family context, see <A HREF="node20.html#list-param-edit-family">19.2.8</A>, page&nbsp;<A HREF="node20.html#list-param-edit-family"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>

<P>

<HR>
<!--Navigation Panel-->
<A NAME="tex2html1270"
  HREF="node20.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1264"
  HREF="sympa.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1258"
  HREF="node18.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1266"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A> 
<A NAME="tex2html1268"
  HREF="node30.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1271"
  HREF="node20.html">19. Lists Families</A>
<B> Up:</B> <A NAME="tex2html1265"
  HREF="sympa.html">Sympa Mailing Lists Management Software version</A>
<B> Previous:</B> <A NAME="tex2html1259"
  HREF="node18.html">17. Mailing list definition</A>
 &nbsp; <B>  <A NAME="tex2html1267"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A NAME="tex2html1269"
  HREF="node30.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
root
2005-08-10
</ADDRESS>
</BODY>
</HTML>
